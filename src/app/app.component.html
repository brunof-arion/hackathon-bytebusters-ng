<main id="container-main" class="container">
  @if (!isLinkedinPage) {
  <div id="not-linkedin-page">Not a LinkedIn profile page</div>
  } @else { @if (!isLogged) {
  <google-auth-button />
  } @else {
  <div class="custom-card">
    <app-user-profile
      [userAvatar]="userAvatar"
      [userEmail]="userEmail"
      [userName]="userName"
    ></app-user-profile>
    <div class="card-content">
      <!-- Select -->
      <mat-form-field>
        <mat-label>Positions</mat-label>
        <mat-select [formControl]="positionsControl">
          <mat-select-trigger>
            @if ((positionsControl.value?.length || 0) > 1) {
            <span class="example-additional-selection">
              {{ positionsControl.value }}
            </span>
            }
          </mat-select-trigger>
          @for (position of positions; track position) {
          <mat-option [value]="position">{{ position }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
      <!-- Evaluation text -->
      @if (this.evaluation.status === false) {
      <p>Evaluation:</p>
      <div class="status-message" style="display: flex; align-items: center">
        <mat-icon
          style="overflow: inherit"
          [style.color]="'red'"
          class="material-icons"
          >{{ "warning" }}</mat-icon
        >
        <p style="margin-left: 8px">{{ evaluation.message }}</p>
      </div>
      } @else if (this.evaluation.status === true) {
      <p>Evaluation:</p>
      <div class="status-message" style="display: flex; align-items: center">
        <mat-icon
          style="overflow: inherit"
          [style.color]="'green'"
          class="material-icons"
          >{{ "success" }}</mat-icon
        >
        <p style="margin-left: 8px">{{ evaluation.message }}</p>
      </div>
      }

      <!-- Loader -->
      @if (isLoading) {
      <div>
        <span>{{ loadingMessage }}</span>
        <mat-progress-bar mode="query"></mat-progress-bar>
      </div>
      } @if (messageGenerated) {
      <div>Message generated! Check your LinkedIn chat window.</div>
      }
    </div>
    <div class="card-actions">
      <!-- Not contacted? -->
      <!-- Show generate message button -->
      <!-- Contacted? -->
      <!-- Show contacted message ok & show select? -->
      @if (!contacted) { @if (!messageGenerated) {
      <button
        mat-raised-button
        (click)="generateMessage()"
        color="primary"
        class="btn generate"
        [disabled]="!positionSelected || isLoading"
      >
        <mat-icon
          aria-hidden="false"
          aria-label="generate message"
          fontIcon="create"
        ></mat-icon>
        Generate message
      </button>
      } @else if (messageGenerated) {
      <button
        mat-raised-button
        (click)="markAsContacted()"
        color="primary"
        class="btn generate"
        [disabled]="!positionSelected || isLoading"
      >
        <mat-icon
          aria-hidden="false"
          aria-label="mark as contacted"
          fontIcon="checkmark"
        ></mat-icon>
        Mark as contacted
      </button>
      } } @else if (contacted) { Candidate was contacted successfully. }
    </div>
  </div>

  }
  <!-- <div>
    <mat-form-field appearance="fill">
      <mat-label>Status</mat-label>
      <mat-select>
        <mat-option value="">Please choose an Status...</mat-option>
        <mat-option value="contacted">contacted</mat-option>
        <mat-option value="said no">said no</mat-option>
        <mat-option value="said yes (interview)">said yes (interview)</mat-option>
        <mat-option value="had questions">had questions</mat-option>
        <mat-option value="positive interview">positive interview</mat-option>
        <mat-option value="negative interview">negative interview</mat-option>
        <mat-option value="discarded candidate">discarded candidate</mat-option>
        <mat-option value="interviewed">Interviewed</mat-option>
      </mat-select>
    </mat-form-field>
    <button mat-raised-button color="primary">Update</button>
  </div> -->
  }
</main>
